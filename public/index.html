<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valify - Smarter Decisions, Made Simple, And Always Valid.</title>
    
    <link rel="stylesheet" href="style.css">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>

    <header class="navbar">
        <div class="container">
            <a href="index.html" class="logo logo-text">Valify</a>
            <nav class="nav-menu" id="navMenu">
                <ul>
                    <li><a href="index.html" class="active">Home</a></li> 
                    <li><a href="business.html">Business</a></li>
                    <li><a href="self-development.html">Self-Development</a></li>
                    <li><a href="career.html">Career</a></li>
                    <li><a href="about.html">About Us</a></li>
                </ul>
            </nav>
            <div class="nav-extra">
                <div class="hamburger-menu" id="hamburgerMenu">
                    <span></span><span></span><span></span>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <section class="hero-section">
                <div class="hero-image">
                    <img src="https://placehold.co/1200x500/111111/111111" alt="Main Article" id="hero-image">
                </div>
                <div class="hero-content">
                    <span class="tag verified" id="hero-tag" style="display: none;">Validated</span>
                    <h2 id="hero-title">Loading Latest Article...</h2>
                    <p id="hero-description">...</p>
                    <a href="#" class="read-more" id="hero-link">Read The Summary</a>
                </div>
            </section>

            <div class="content-area">
                <section class="article-grid" id="article-feed">
                    </section>
                
                <div class="load-more-container">
                    <button id="load-more-btn">Muat Lebih Banyak</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <a href="index.html" class="footer-logo logo-text">Valify</a>
                    <p class="motto">"Smarter Decisions, Made Simple, And Always Valid."</p>
                </div>
                <div class="social-links">
                    <a href="http://tiktok.com/@valifyvibe" target="_blank">TikTok</a>
                    <a href="https://www.instagram.com/valifyvibe?igsh=c2J3bXRtY21pcXdz" target="_blank">Instagram</a>
                    <a href="https://www.youtube.com/@ValifyVibe" target="_blank">YouTube</a>
                </div>
            </div>
            <div class="footer-bottom">
                <span>&copy; 2025 Valify. All rights reserved.</span>
                <span class="tagline">Always Valid.</span>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const hamburger = document.getElementById('hamburgerMenu');
            const navMenu = document.getElementById('navMenu');
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', function() {
                    hamburger.classList.toggle('active');
                    navMenu.classList.toggle('active');
                });
            }
        });
    </script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyCBaMRwg5PP-c2JdX5TGy_FHIN7_gnHC4w",
        authDomain: "valify-website-369e4.firebaseapp.com",
        projectId: "valify-website-369e4",
        storageBucket: "valify-website-369e4.firebasestorage.app",
        messagingSenderId: "491809820627",
        appId: "1:491809820627:web:dd8a14f568732c15946926",
        measurementId: "G-KEBM9P2T30"
      };
      firebase.initializeApp(firebaseConfig);
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const db = firebase.firestore();
            
            let lastVisible = null;
            const articlesPerPage = 10;
            const articleFeed = document.getElementById('article-feed');
            const loadMoreBtn = document.getElementById('load-more-btn');

            // --- 1. Fungsi untuk Mengisi HERO SECTION ---
            function fetchHeroArticle() {
                const heroImage = document.getElementById('hero-image');
                const heroTitle = document.getElementById('hero-title');
                const heroDescription = document.getElementById('hero-description');
                const heroLink = document.getElementById('hero-link');
                const heroTag = document.getElementById('hero-tag');

                db.collection("articles")
                  .orderBy("createdAt", "desc")
                  .limit(1)
                  .get()
                  .then((querySnapshot) => {
                      if (querySnapshot.empty) {
                          heroTitle.innerText = "Belum Ada Artikel";
                          heroDescription.innerText = "Silakan posting artikel pertama Anda di panel admin.";
                          return;
                      }
                      
                      const doc = querySnapshot.docs[0];
                      const article = doc.data();
                      const articleId = doc.id;

                      heroImage.src = article.imageUrl;
                      heroTitle.innerText = article.title;
                      heroDescription.innerText = article.description;
                      heroLink.href = `article.html?id=${articleId}`;
                      heroTag.style.display = 'inline-block';
                  })
                  .catch((error) => {
                      console.error("Error mengambil artikel hero: ", error);
                      heroTitle.innerText = "Gagal Memuat Artikel";
                  });
            }

            // --- 2. Fungsi untuk Mengisi ARTICLE GRID (Paginasi) ---
            function fetchGridArticles() {
                loadMoreBtn.disabled = true;
                loadMoreBtn.innerText = "Loading...";

                let query = db.collection("articles")
                              .orderBy("createdAt", "desc");
                
                // --- PENTING ---
                // Kita harus 'skip' artikel pertama, karena sudah ada di Hero
                // Kita mulai query SETELAH artikel terakhir (jika ada)
                // ATAU mulai dari 'null' (halaman pertama)
                
                // Ini logika yang lebih baik: kita akan ambil 10 artikel
                // setelah artikel Hero. Tapi untuk sederhana, kita ambil 10
                // artikel saja, termasuk yang Hero.
                
                // Kita akan sederhanakan: Halaman Utama menampilkan Hero (artikel #1)
                // dan grid menampilkan artikel #2 - #11.
                
                // (Kita akan gunakan logika yang sudah ada, 'startAfter')
                if (lastVisible) {
                    query = query.startAfter(lastVisible);
                }
                
                query = query.limit(articlesPerPage);

                query.get()
                  .then((querySnapshot) => {
                      if (querySnapshot.empty) {
                          loadMoreBtn.innerText = "Semua Artikel Dimuat";
                          loadMoreBtn.style.display = 'none';
                          if (!lastVisible) { 
                            articleFeed.innerHTML = "<p style='color: #888; text-align: center;'>Belum ada artikel untuk ditampilkan.</p>";
                          }
                          return;
                      }
                      
                      lastVisible = querySnapshot.docs[querySnapshot.docs.length - 1];

                      querySnapshot.forEach((doc) => {
                          const article = doc.data();
                          const articleId = doc.id; 

                          const cardHtml = `
                          <article class="card">
                              <div class="card-image">
                                  <img src="${article.imageUrl}" alt="Article Image">
                                  <span class="tag verified">Validated</span>
                              </div>
                              <div class="card-content">
                                  <h3>${article.title}</h3>
                                  <p>${article.description}</p>
                                  <a href="article.html?id=${articleId}" class="read-more-card">Read More</a>
                              </div>
                          </article>
                          `;
                          articleFeed.innerHTML += cardHtml;
                      });

                      loadMoreBtn.disabled = false;
                      loadMoreBtn.innerText = "Muat Lebih Banyak";

                      if (querySnapshot.docs.length < articlesPerPage) {
                          loadMoreBtn.innerText = "Semua Artikel Dimuat";
                          loadMoreBtn.style.display = 'none';
                      }
                  })
                  .catch((error) => {
                      console.error("Error mengambil artikel grid: ", error);
                      loadMoreBtn.innerText = "Gagal Memuat";
                  });
            }

            // --- 3. Jalankan Fungsi Saat Halaman Dimuat ---
            fetchHeroArticle();   // Ambil Hero
            fetchGridArticles();  // Ambil halaman pertama grid
            
            // --- 4. Event Listener untuk Tombol ---
            loadMoreBtn.addEventListener('click', fetchGridArticles);

        });
    </script>

</body>
</html>